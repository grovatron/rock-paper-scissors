<!doctype html>
<html>
    <head>
        <title>Rock, Paper, Scissors!</title>
        <meta charset="UTF-8">
    </head>
    <body>
        <script>
        
          function computerPlay() {
              let computerChoices = ['rock', 'paper', 'scissors'];
              let choiceIndex = randomInt(computerChoices.length);
              return computerChoices[choiceIndex];
          }

          function randomInt(upperLimit) {
              return Math.floor(Math.random() * upperLimit);
          }

          function playRound(playerSelection, computerSelection) {
              let playerChoice = playerSelection.toLocaleLowerCase();
              let result = getResult(playerChoice, computerSelection);
              return createResultString(playerChoice, computerSelection, result);
          }

          function getResult(playerSelection, computerSelection) {
              let result;
              if (playerSelection === 'rock') {
                  if (computerSelection === 'paper') {
                      result = 'lose';
                  } else if (computerSelection === 'scissors') {
                      result = 'win';
                  } else {
                      result = 'tie';
                  }
              } else if (playerSelection === 'paper') {
                  if (computerSelection === 'scissors') {
                      result = 'lose';
                  } else if (computerSelection === 'rock') {
                      result = 'win';
                  } else {
                      result = 'tie';
                  }
              } else {
                  if (computerSelection === 'rock') {
                      result = 'lose';
                  } else if (computerSelection === 'paper') {
                      result = 'win';
                  }  else {
                      result = 'tie';
                  }
              }
              return result;
          }

          function createResultString(playerChoice, computerChoice, result) {
              if (result === 'win') {
                  return `You win! ${capitalize(playerChoice)} beats ${computerChoice}!`;
              } else if (result === 'lose') {
                  return `You lose! ${capitalize(computerChoice)} beats ${playerChoice}!`;
              } else {
                  return "It's a tie!";
              }
          }

          function capitalize(str) {
              if (str.length <= 1) {
                  return str.toLocaleUpperCase();
              } else {
                  return str.substring(0,1).toLocaleUpperCase() + str.substring(1).toLocaleLowerCase();
              }
          }

          function game() {
              let playerScore = 0;
              let computerScore = 0;

              for (let i = 0; i < 5; i++) {
                  let playerChoice;
                  while (playerChoice === undefined || !(playerChoice.toLowerCase() === 'rock' || playerChoice.toLowerCase() === 'paper' || playerChoice.toLowerCase() === 'scissors')) {
                      playerChoice = prompt("Rock, Paper, or Scissors?");
                  }
                  let computerChoice = computerPlay();
                  let resultString = playRound(playerChoice, computerChoice);
                  if (resultString.includes('win')) {
                      playerScore += 1;
                  } else if (resultString.includes('lose')) {
                      computerScore +=1;
                  }
                  console.log(resultString);
                  console.log(`Player: ${playerScore}    Computer: ${computerScore}`);
              }
              if (playerScore > computerScore) {
                  console.log('Player wins!');
              } else if (computerScore > playerScore) {
                  console.log('Computer wins!');
              } else {
                  console.log('Game ends in a tie!');
              }
          }
          
          game();
        </script>
    </body>
</html>
